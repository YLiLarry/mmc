gcc ./cnma/*.c  -DPROFILE_FGEMM_MP=1 -DTIME_MMC=1 -DPSEUDO_RANDOM_MMC=0 -DDEBUG_MMC=0 -DCHECK_MMC=0 -std=c11 -O2 -c -Wall 
g++ main_benchmark_fgemm_mp.cpp  *.o  -DPROFILE_FGEMM_MP=1 -DTIME_MMC=1 -DPSEUDO_RANDOM_MMC=0 -DDEBUG_MMC=0 -DCHECK_MMC=0 -O2 -Wall --std=c++11 -I"/home/y667li/mmc/build/linbox/include" -I"/home/y667li/mmc/build/givaro/include" -I"/home/y667li/mmc/build/fflas-ffpack/include" -L"/home/y667li/mmc/build/linbox/lib" -L"/home/y667li/mmc/build/givaro/lib" -L"/home/y667li/mmc/build/OpenBLAS/lib" -L"/home/y667li/mmc/build/fflas-ffpack/lib" -lgivaro -lopenblas -llinbox -lgmp -fopenmp 
make run
make[1]: Entering directory `/home/y667li/mmc'
chmod u+x ./a.out
./a.out
benchmarking with random inputs in Givaro::Modular<Ints>(integer of 131072 bits)
===========================================
============= Benchmark Naive =============
===========================================
-------------------------------
FGEMM_MP: nb prime: 12162
FGEMM_MP:  product: 262170 bits
FGEMM_MP:     init: 12580ms
FGEMM_MP:   to RNS: 50859ms
==========================================
Pointwise fgemm : 5.44144 (12162) moduli 
==========================================
FGEMM_MP:  RNS Mul: 5442ms
FGEMM_MP: from RNS: 42609ms
-------------------------------
===========================================
======= Benchmark TwoPhaseMargeLeast ======
===========================================
########## TwoPhaseAlgo constructor ##########
 - m_level_1_moduli:  - count: 162
 - max bit length: 2243
 - product bit length: 262572

 - m_level_2_moduli:  - count: 214
 - max bit length: 21
 - product bit length: 4494

########## TwoPhaseAlgo constructor ends ##########
########## matrix_reduce ##########
..... phase 1 reduce .....
.........................................
Timer: 5.04963s (3.25215 cpu) [1]
..... phase 1 reduce ends .....
..... phase 2 reduce .....
.......... finit_rns ..........
.......... finit_rns ends ..........
Timer: 12.149s (11.9987 cpu) [1]
..... phase 2 reduce ends .....
########## matrix_reduce ends ##########
########## matrix_reduce ##########
..... phase 1 reduce .....
.........................................
Timer: 5.05669s (3.22355 cpu) [1]
..... phase 1 reduce ends .....
..... phase 2 reduce .....
.......... finit_rns ..........
.......... finit_rns ends ..........
Timer: 12.1648s (12.0105 cpu) [1]
..... phase 2 reduce ends .....
########## matrix_reduce ends ##########
########## phase2_mult ##########
.......... fgemm ..........
==========================================
Pointwise fgemm : 15.2194 (34668) moduli 
==========================================
.......... fgemm ends ..........
########## phase2_mult ends ##########
########## matrix_recover ##########
..... phase 2 recovery .....
.......... fflas_new_sim_recover ..........
.......... fconvert_rns ..........
.......... fconvert_rns ends ..........
.......... fflas_new_sim_recover ends ..........
Timer: 6.36871s (6.15707 cpu) [1]
..... phase 2 recovery ends .....
..... phase 1 recovery .....
.......... precompute_Mi_marge ..........
.......... precompute_Mi_marge ends ..........
.........................................
Timer: 280.996s (278.128 cpu) [1]
..... phase 1 recovery ends .....
########## matrix_recover ends ##########
===========================================
======= Benchmark TwoPhaseMargeMost =======
===========================================
########## TwoPhaseAlgo constructor ##########
 - m_level_1_moduli:  - count: 69
 - max bit length: 4093
 - product bit length: 263173

 - m_level_2_moduli:  - count: 391
 - max bit length: 21
 - product bit length: 8211

########## TwoPhaseAlgo constructor ends ##########
########## matrix_reduce ##########
..... phase 1 reduce .....
.........................................
Timer: 2.24542s (1.53485 cpu) [1]
..... phase 1 reduce ends .....
..... phase 2 reduce .....
.......... finit_rns ..........
.......... finit_rns ends ..........
Timer: 10.4981s (10.3818 cpu) [1]
..... phase 2 reduce ends .....
########## matrix_reduce ends ##########
########## matrix_reduce ##########
..... phase 1 reduce .....
.........................................
Timer: 2.23588s (1.58523 cpu) [1]
..... phase 1 reduce ends .....
..... phase 2 reduce .....
.......... finit_rns ..........
.......... finit_rns ends ..........
Timer: 10.5068s (10.3745 cpu) [1]
..... phase 2 reduce ends .....
########## matrix_reduce ends ##########
########## phase2_mult ##########
.......... fgemm ..........
==========================================
Pointwise fgemm : 11.851 (26979) moduli 
==========================================
.......... fgemm ends ..........
########## phase2_mult ends ##########
########## matrix_recover ##########
..... phase 2 recovery .....
.......... fflas_new_sim_recover ..........
.......... fconvert_rns ..........
.......... fconvert_rns ends ..........
.......... fflas_new_sim_recover ends ..........
Timer: 6.67574s (6.5355 cpu) [1]
..... phase 2 recovery ends .....
..... phase 1 recovery .....
.......... precompute_Mi_marge ..........
.......... precompute_Mi_marge ends ..........
.........................................
Timer: 81.3939s (79.9476 cpu) [1]
..... phase 1 recovery ends .....
########## matrix_recover ends ##########
===========================================
====== Benchmark TwoPhasePargeBlock =======
===========================================
expo: 0000000000000000000000000000000000000000000000000000000011111111
expo: 0000000000000000000000000000000000000000000000000000000011111110
expo: 0000000000000000000000000000000000000000000000000000000011111100
expo: 0000000000000000000000000000000000000000000000000000000011111000
expo: 0000000000000000000000000000000000000000000000000000000011110000
expo: 0000000000000000000000000000000000000000000000000000000011100000
expo: 0000000000000000000000000000000000000000000000000000000011000000
expo: 0000000000000000000000000000000000000000000000000000000010000000
expo: 0000000000000000000000000000000000000000000000001111111100000000
expo: 0000000000000000000000000000000000000000000000001111111000000000
expo: 0000000000000000000000000000000000000000000000001111110000000000
expo: 0000000000000000000000000000000000000000000000001111100000000000
expo: 0000000000000000000000000000000000000000000000001111000000000000
########## TwoPhaseAlgo constructor ##########
 - m_level_1_moduli:  - count: 13
 - max bit length: 65281
 - product bit length: 321538

 - m_level_2_moduli:  - count: 6227
 - max bit length: 21
 - product bit length: 130569

########## TwoPhaseAlgo constructor ends ##########
########## matrix_reduce ##########
..... phase 1 reduce .....
.........................................
Timer: 0.389478s (0.304883 cpu) [1]
..... phase 1 reduce ends .....
..... phase 2 reduce .....
.......... finit_rns ..........
.......... finit_rns ends ..........
Timer: 96.4506s (95.6697 cpu) [1]
..... phase 2 reduce ends .....
########## matrix_reduce ends ##########
########## matrix_reduce ##########
..... phase 1 reduce .....
.........................................
Timer: 0.401052s (0.332386 cpu) [1]
..... phase 1 reduce ends .....
..... phase 2 reduce .....
.......... finit_rns ..........
.......... finit_rns ends ..........
Timer: 96.4472s (95.6612 cpu) [1]
..... phase 2 reduce ends .....
########## matrix_reduce ends ##########
########## phase2_mult ##########
.......... fgemm ..........
==========================================
Pointwise fgemm : 36.0082 (80951) moduli 
==========================================
.......... fgemm ends ..........
########## phase2_mult ends ##########
########## matrix_recover ##########
..... phase 2 recovery .....
.......... fflas_new_sim_recover ..........
.......... fconvert_rns ..........
.......... fconvert_rns ends ..........
.......... fflas_new_sim_recover ends ..........
Timer: 148.693s (147.875 cpu) [1]
..... phase 2 recovery ends .....
..... phase 1 recovery .....
.......... precompute_Mi_parge_block ..........
.......... precompute_Mi_parge_block ends ..........
.........................................
Timer: 23.8576s (23.828 cpu) [1]
..... phase 1 recovery ends .....
########## matrix_recover ends ##########
-------------------------------
FGEMM_MP: nb prime: 12161
FGEMM_MP:  product: 262156 bits
FGEMM_MP:     init: 12550ms
FGEMM_MP:   to RNS: 50841ms
==========================================
Pointwise fgemm : 5.43229 (12161) moduli 
==========================================
FGEMM_MP:  RNS Mul: 5433ms
FGEMM_MP: from RNS: 42881ms
-------------------------------
-------------------------------
FGEMM_MP: nb prime: 6083
FGEMM_MP:  product: 131130 bits
FGEMM_MP:     init: 3158ms
FGEMM_MP:   to RNS: 12842ms
==========================================
Pointwise fgemm : 0.29671 (6083) moduli 
==========================================
FGEMM_MP:  RNS Mul: 297ms
FGEMM_MP: from RNS: 278ms
-------------------------------
-------------------------------
FGEMM_MP: nb prime: 12163
FGEMM_MP:  product: 262204 bits
FGEMM_MP:     init: 12502ms
FGEMM_MP:   to RNS: 26062ms
==========================================
Pointwise fgemm : 0.586874 (12163) moduli 
==========================================
FGEMM_MP:  RNS Mul: 587ms
FGEMM_MP: from RNS: 1154ms
-------------------------------
-------------------------------
FGEMM_MP: nb prime: 12166
FGEMM_MP:  product: 262192 bits
FGEMM_MP:     init: 12495ms
FGEMM_MP:   to RNS: 46373ms
==========================================
Pointwise fgemm : 0.587193 (12166) moduli 
==========================================
FGEMM_MP:  RNS Mul: 587ms
FGEMM_MP: from RNS: 1176ms
-------------------------------
Time fgemm: 110.98 Gfops: 4.72417e-06 (total:110.98) N6Givaro7IntegerE | perword: 0.0096751 | benchmarked with random inputs in Givaro::Modular<Ints>(integer of 131072 bits) |  -q -1 -b 131072 -m 64 -k 64 -n 64 -w -1 -i 1 -s 1532427036  | Freivalds: 116.671
Time TwoPhaseMargeLeast: 334.936
Time TwoPhaseMargeMost: 126.026
Time TwoPhasePargeBlock: 416.061
Time Naive: 110.79
make[1]: Leaving directory `/home/y667li/mmc'
